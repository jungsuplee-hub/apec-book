<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>APEC Meeting Rooms - Display Launcher</title>
  <link rel="stylesheet" href="/static/style.css" />
  <link rel="icon" type="image/x-icon" href="https://www.apecceosummitkorea2025.com/images/favicon.ico" />
</head>
<body>
<header class="topbar">
  <div class="topbar-inner">
    <div class="brand">
      <a href="/" class="brand-logo" aria-label="Home">
        <img src="/static/logo-apec.png" alt="APEC" />
      </a>
      <span class="brand-caption">MEETING ROOM RESERVATION</span>
    </div>
    <nav class="nav">
      <a href="/admin" class="button">Admin</a>
    </nav>
  </div>
</header>

<main class="wrap">
  <section class="card">
    <h2 class="title">Quick Display Launcher</h2>
    
    <!-- 날짜 선택 버튼 -->
    <div class="row" id="dateButtons" style="display:flex;flex-wrap:wrap;gap:8px;margin-bottom:20px"></div>

    <!-- 룸 버튼 -->
    <div id="roomBlocks" style="display:grid;gap:20px"></div>
  </section>
</main>

<script>
  const EVENT_DATES = {{ event_dates|tojson|safe }};
  const ALL_ROOMS   = {{ all_room_codes|tojson|safe }};
  const ROOM_LABEL  = {{ room_label|tojson|safe }};
  let chosenDate = EVENT_DATES[0];

  const dateRow = document.getElementById('dateButtons');
  const roomBlocks = document.getElementById('roomBlocks');

  function renderDates(){
    dateRow.innerHTML = EVENT_DATES.map(d => `
      <button class="chip chip-accent" data-date="${d}">${d}</button>
    `).join('');
    dateRow.querySelectorAll('button').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        chosenDate = btn.dataset.date;
        renderRooms();
        dateRow.querySelectorAll('button').forEach(x=>x.classList.remove('chip-active'));
        btn.classList.add('chip-active');
      });
    });
    dateRow.querySelector(`button[data-date="${chosenDate}"]`).classList.add('chip-active');
  }

  function renderRooms(){
    const roomBtns = ALL_ROOMS.map(r=>{
      const href = `/display?room=${encodeURIComponent(r)}&date=${encodeURIComponent(chosenDate)}`;
      return `<a class="chip chip-gold" href="${href}">${ROOM_LABEL[r]||r}</a>`;
    }).join('');
    roomBlocks.innerHTML = `
      <div class="panel">
        <div class="panel-title">All rooms</div>
        <div class="panel-body" style="display:flex;flex-wrap:wrap;gap:8px">${roomBtns}</div>
      </div>
    `;
  }

  renderDates();
  renderRooms();
</script>
</body>
</html>

